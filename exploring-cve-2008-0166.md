# Metasploitable 2: Exploring CVE-2008-0166 (OpenSSH Weak PRNG)

## üìå Project Overview
This experiment documents the investigation of a critical vulnerability in **OpenSSH 4.7p1** on a **Metasploitable 2** target. The vulnerability, identified as **CVE-2008-0166**, stems from a weak Pseudo-Random Number Generator (PRNG) in certain Debian-based OpenSSL versions, making cryptographic keys predictable and susceptible to brute-force attacks.

## üõ†Ô∏è Lab Architecture
* **Attacker Machine:** Kali Linux
* **Target Machine:** Metasploitable 2 (OpenSSH 4.7p1 Debian 8ubuntu1)
* **Network Environment:** Isolated Virtual Lab

---

## üöÄ Execution & Findings

### 1. Reconnaissance & Service Identification
I performed a service version scan to identify the specific OpenSSH version running on the target.
* **Command:** `nmap -sV [TARGET_IP]`
* **Discovery:** The target machine is running **OpenSSH 4.7p1 Debian 8ubuntu1**.
* **Vulnerability Analysis:** This specific version is known to implement a weak PRNG, which leads to the generation of a limited set of predictable SSH keys.

### 2. Exploit Research & Preparation
I researched known exploits for this vulnerability and prepared the necessary environment.
* **Resources:** Identified exploit scripts on Exploit-DB (e.g., IDs **5622**, **5632**, and **5720**).
* **Key Acquisition:** Created a new directory and downloaded precalculated keys using `wget`, then extracted them using `tar`.
* **Script Setup:** Added a provided Ruby script to the directory and made it executable using `chmod`.

### 3. Exploitation Attempt
I executed the script to brute-force the predictable key space.
* **Script Execution:** The script initially required troubleshooting as it was looking for files with specific naming conventions (only numbers), which I corrected.
* **Brute-Force Result:** The script eventually returned what appeared to be the correct key.
* **Testing:** Upon testing the discovered key, it was found to be incorrect as it still required a password to SSH successfully.
* **Current Status:** Currently unsure as to why this failed but will come back to it.

---

## üìà Lessons Learned & Technical Discoveries
* **PRNG Predictability:** This vulnerability highlights the extreme risk of a compromised random number generator. If the entropy source is flawed, the resulting "random" keys can be easily mapped and brute-forced.
* **Exploit Reliability:** Even when a script identifies a potential key match, environmental factors or configuration differences can prevent the exploit from succeeding.
* **Persistence in Troubleshooting:** The experiment required several adjustments to the exploit environment and script logic, reinforcing the need to understand how automated tools interact with their underlying data sets.

## üìÖ Next Steps
* **Future Plan:** My next plan for this exploit is to utilize **Metasploit's `ssh_login`** functions to attempt to gain access.
